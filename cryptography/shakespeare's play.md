# Shakespeare's play
![image](https://user-images.githubusercontent.com/34862954/164957376-84084b96-bfff-4bd5-8e5d-f7780111e26f.png)

## Approach
In this question, we are provided with a public key. But we need a corresponding private key for password less login into the ssh server. So in order to solve this, let's dig deeper to what public key and private key are made of.
```
let p and q be two prime numbers.
n = p*q
phi(n) = (p-1)*(q-1)
there exists a number e such that 1 < e < phi(n) and gcd(e, phi(n)) = 1
public key contains n and e
```

So let's just extract n and e from the public key using `Crypto.PublicKey`.
Here is the script which will extract n and e from public key.

```python
from Crypto.PublicKey import RSA

public_key = RSA.importKey(open('shakespeare.pub', 'r').read())

print("n: ", public_key.n)
print("e: ", public_key.e)
```

Now from [prime-factorization-tool](https://www.dcode.fr/prime-factors-decomposition), we get the `p` and `q` from `n`.
Using [rsatool](https://github.com/ius/rsatool), we can generate the private key.


> python rsatool.py -n 23581307565875783450880441044397544525753615046563293324757202552113961917309446553136746041631566499421649033253963840319093783233181612657946393533225448113711518909237114984428569482767264210170670219746982460726750112514574111792823163808395487277649678541195051080408450926897056087891124657243676620862773633455935564245011575135749325632228220516471054338397141815862334230585792296835013157525226291597546657176517358613551133942359405961327859542207545273808210353613597694107447620102535859994589945931897905500425097345103861973345049390081150489398871375472164554127554299497511525189147314028526447845443  -e 65537 -p 153562064214687422424817602402717993505096923215767339470481593480368881969716167936367216954518602201254195552554422718068710003926852723078706868420227221457027416427671236324951107969976478395087281503807751767448228430516636493223125402346276138985674707413121675829011661155825827873841919976527994073759 -q 153562064214687422424817602402717993505096923215767339470481593480368881969716167936367216954518602201254195552554422718068710003926852723078706868420227221457027416427671236324951107969976478395087281503807751767448228430516636493223125402346276138985674707413121675829011661155825827873841919976527994074077 -f PEM -o privkey.pem

In order to use `private.pem`, we need to change permissions to read write permission to only owner.
```
chmod 600 privkey.pem
```

Now we can ssh into the server using this key:
```
ssh shakespeare@wannahack.copsiitbhu.co.in -p 2498 -i privkey.pem
```
![image](https://user-images.githubusercontent.com/34862954/164958217-79eb9796-4749-408d-b2ff-ae85c18352b5.png)

flag: `wannahack{__congratulation_on_solving_this_problem__}`





